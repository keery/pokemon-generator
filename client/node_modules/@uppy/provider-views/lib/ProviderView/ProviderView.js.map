{"version":3,"sources":["ProviderView.js"],"names":["h","require","generateFileID","getFileType","isPreviewSupported","AuthView","Header","Browser","LoaderView","SharedHandler","CloseWrapper","getOrigin","location","origin","module","exports","ProviderView","constructor","plugin","opts","provider","defaultOptions","viewType","showTitles","showFilter","showBreadcrumbs","addFile","bind","filterQuery","getFolder","getNextFolder","logout","preFirstRender","handleAuth","handleError","handleScroll","listAllFiles","donePicking","cancelPicking","clearSelection","render","setPluginState","authenticated","files","folders","directories","filterInput","isSearchVisible","tearDown","didFirstRender","onFirstRender","id","name","loaderWrapper","list","res","updatedDirectories","state","getPluginState","index","findIndex","dir","slice","concat","title","username","folder","requestPath","lastCheckbox","undefined","file","tagFile","providerFileToId","source","data","type","mimeType","isRemote","body","fileId","remote","companionUrl","url","fileUrl","providerOptions","fileType","preview","thumbnail","uppy","log","err","isRestriction","then","ok","revoked","message","i18n","manual_revoke_url","info","newState","catch","e","target","value","addFolder","folderId","selectedFolders","loading","count","forEach","checkIfFileAlreadyExists","ids","map","length","smart_count","authState","btoa","JSON","stringify","clientVersion","VERSION","link","authUrl","uppyVersions","authWindow","window","open","handleToken","companionAllowedHosts","parse","token","close","removeEventListener","setAuthToken","addEventListener","error","toString","isAuthError","details","scrollPos","scrollHeight","scrollTop","offsetHeight","path","nextPagePath","Promise","resolve","reject","items","item","isFolder","push","moreFiles","currentSelection","promises","all","dashboard","getPlugin","hideAllPanels","viewOptions","icon","i18nArray","targetViewOptions","headerProps","pluginIcon","browserProps","filterItems","isChecked","toggleCheckbox","done","cancel","headerComponent","uppyFiles","getFiles","validateRestrictions","args","allowedOrigin","getRegex","RegExp","patterns","Array","isArray","filter","pattern","some","test"],"mappings":"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","sourcesContent":["const { h } = require('preact')\nconst generateFileID = require('@uppy/utils/lib/generateFileID')\nconst getFileType = require('@uppy/utils/lib/getFileType')\nconst isPreviewSupported = require('@uppy/utils/lib/isPreviewSupported')\nconst AuthView = require('./AuthView')\nconst Header = require('./Header')\nconst Browser = require('../Browser')\nconst LoaderView = require('../Loader')\nconst SharedHandler = require('../SharedHandler')\nconst CloseWrapper = require('../CloseWrapper')\n\nfunction getOrigin () {\n  // eslint-disable-next-line no-restricted-globals\n  return location.origin\n}\n\n/**\n * Class to easily generate generic views for Provider plugins\n */\nmodule.exports = class ProviderView {\n  static VERSION = require('../../package.json').version\n\n  #isHandlingScroll\n\n  #sharedHandler\n\n  /**\n   * @param {object} plugin instance of the plugin\n   * @param {object} opts\n   */\n  constructor (plugin, opts) {\n    this.plugin = plugin\n    this.provider = opts.provider\n    this.#sharedHandler = new SharedHandler(plugin)\n\n    // set default options\n    const defaultOptions = {\n      viewType: 'list',\n      showTitles: true,\n      showFilter: true,\n      showBreadcrumbs: true,\n    }\n\n    // merge default options with the ones set by user\n    this.opts = { ...defaultOptions, ...opts }\n\n    // Logic\n    this.addFile = this.addFile.bind(this)\n    this.filterQuery = this.filterQuery.bind(this)\n    this.getFolder = this.getFolder.bind(this)\n    this.getNextFolder = this.getNextFolder.bind(this)\n    this.logout = this.logout.bind(this)\n    this.preFirstRender = this.preFirstRender.bind(this)\n    this.handleAuth = this.handleAuth.bind(this)\n    this.handleError = this.handleError.bind(this)\n    this.handleScroll = this.handleScroll.bind(this)\n    this.listAllFiles = this.listAllFiles.bind(this)\n    this.donePicking = this.donePicking.bind(this)\n    this.cancelPicking = this.cancelPicking.bind(this)\n    this.clearSelection = this.clearSelection.bind(this)\n\n    // Visual\n    this.render = this.render.bind(this)\n\n    this.clearSelection()\n\n    // Set default state for the plugin\n    this.plugin.setPluginState({\n      authenticated: false,\n      files: [],\n      folders: [],\n      directories: [],\n      filterInput: '',\n      isSearchVisible: false,\n    })\n  }\n\n  tearDown () {\n    // Nothing.\n  }\n\n  #updateFilesAndFolders (res, files, folders) {\n    this.nextPagePath = res.nextPagePath\n    res.items.forEach((item) => {\n      if (item.isFolder) {\n        folders.push(item)\n      } else {\n        files.push(item)\n      }\n    })\n\n    this.plugin.setPluginState({ folders, files })\n  }\n\n  /**\n   * Called only the first time the provider view is rendered.\n   * Kind of like an init function.\n   */\n  preFirstRender () {\n    this.plugin.setPluginState({ didFirstRender: true })\n    this.plugin.onFirstRender()\n  }\n\n  /**\n   * Based on folder ID, fetch a new folder and update it to state\n   *\n   * @param  {string} id Folder id\n   * @returns {Promise}   Folders/files in folder\n   */\n  getFolder (id, name) {\n    return this.#sharedHandler.loaderWrapper(\n      this.provider.list(id),\n      (res) => {\n        const folders = []\n        const files = []\n        let updatedDirectories\n\n        const state = this.plugin.getPluginState()\n        const index = state.directories.findIndex((dir) => id === dir.id)\n\n        if (index !== -1) {\n          updatedDirectories = state.directories.slice(0, index + 1)\n        } else {\n          updatedDirectories = state.directories.concat([{ id, title: name }])\n        }\n\n        this.username = res.username || this.username\n        this.#updateFilesAndFolders(res, files, folders)\n        this.plugin.setPluginState({ directories: updatedDirectories })\n      },\n      this.handleError\n    )\n  }\n\n  /**\n   * Fetches new folder\n   *\n   * @param  {object} folder\n   */\n  getNextFolder (folder) {\n    this.getFolder(folder.requestPath, folder.name)\n    this.lastCheckbox = undefined\n  }\n\n  addFile (file) {\n    const tagFile = {\n      id: this.providerFileToId(file),\n      source: this.plugin.id,\n      data: file,\n      name: file.name || file.id,\n      type: file.mimeType,\n      isRemote: true,\n      body: {\n        fileId: file.id,\n      },\n      remote: {\n        companionUrl: this.plugin.opts.companionUrl,\n        url: `${this.provider.fileUrl(file.requestPath)}`,\n        body: {\n          fileId: file.id,\n        },\n        providerOptions: this.provider.opts,\n      },\n    }\n\n    const fileType = getFileType(tagFile)\n    // TODO Should we just always use the thumbnail URL if it exists?\n    if (fileType && isPreviewSupported(fileType)) {\n      tagFile.preview = file.thumbnail\n    }\n    this.plugin.uppy.log('Adding remote file')\n    try {\n      this.plugin.uppy.addFile(tagFile)\n      return true\n    } catch (err) {\n      if (!err.isRestriction) {\n        this.plugin.uppy.log(err)\n      }\n      return false\n    }\n  }\n\n  /**\n   * Removes session token on client side.\n   */\n  logout () {\n    this.provider.logout()\n      .then((res) => {\n        if (res.ok) {\n          if (!res.revoked) {\n            const message = this.plugin.uppy.i18n('companionUnauthorizeHint', {\n              provider: this.plugin.title,\n              url: res.manual_revoke_url,\n            })\n            this.plugin.uppy.info(message, 'info', 7000)\n          }\n\n          const newState = {\n            authenticated: false,\n            files: [],\n            folders: [],\n            directories: [],\n          }\n          this.plugin.setPluginState(newState)\n        }\n      }).catch(this.handleError)\n  }\n\n  filterQuery (e) {\n    const state = this.plugin.getPluginState()\n    this.plugin.setPluginState({ ...state, filterInput: e ? e.target.value : '' })\n  }\n\n  /**\n   * Adds all files found inside of specified folder.\n   *\n   * Uses separated state while folder contents are being fetched and\n   * mantains list of selected folders, which are separated from files.\n   */\n  addFolder (folder) {\n    const folderId = this.providerFileToId(folder)\n    const state = this.plugin.getPluginState()\n    const folders = { ...state.selectedFolders }\n\n    if (folderId in folders && folders[folderId].loading) {\n      return\n    }\n\n    folders[folderId] = { loading: true, files: [] }\n\n    this.plugin.setPluginState({ selectedFolders: { ...folders } })\n\n    // eslint-disable-next-line consistent-return\n    return this.listAllFiles(folder.requestPath).then((files) => {\n      let count = 0\n\n      // If the same folder is added again, we don't want to send\n      // X amount of duplicate file notifications, we want to say\n      // the folder was already added. This checks if all files are duplicate,\n      // if that's the case, we don't add the files.\n      files.forEach(file => {\n        const id = this.providerFileToId(file)\n        if (!this.plugin.uppy.checkIfFileAlreadyExists(id)) {\n          count++\n        }\n      })\n\n      if (count > 0) {\n        files.forEach((file) => this.addFile(file))\n      }\n\n      const ids = files.map(this.providerFileToId)\n\n      folders[folderId] = {\n        loading: false,\n        files: ids,\n      }\n      this.plugin.setPluginState({ selectedFolders: folders })\n\n      let message\n\n      if (count === 0) {\n        message = this.plugin.uppy.i18n('folderAlreadyAdded', {\n          folder: folder.name,\n        })\n      } else if (files.length) {\n        message = this.plugin.uppy.i18n('folderAdded', {\n          smart_count: count, folder: folder.name,\n        })\n      } else {\n        message = this.plugin.uppy.i18n('emptyFolderAdded')\n      }\n\n      this.plugin.uppy.info(message)\n    }).catch((e) => {\n      const state = this.plugin.getPluginState()\n      const selectedFolders = { ...state.selectedFolders }\n      delete selectedFolders[folderId]\n      this.plugin.setPluginState({ selectedFolders })\n      this.handleError(e)\n    })\n  }\n\n  providerFileToId (file) {\n    return generateFileID({\n      data: file,\n      name: file.name || file.id,\n      type: file.mimeType,\n    })\n  }\n\n  handleAuth () {\n    const authState = btoa(JSON.stringify({ origin: getOrigin() }))\n    const clientVersion = `@uppy/provider-views=${ProviderView.VERSION}`\n    const link = this.provider.authUrl({ state: authState, uppyVersions: clientVersion })\n\n    const authWindow = window.open(link, '_blank')\n    const handleToken = (e) => {\n      if (!this.#isOriginAllowed(e.origin, this.plugin.opts.companionAllowedHosts) || e.source !== authWindow) {\n        this.plugin.uppy.log(`rejecting event from ${e.origin} vs allowed pattern ${this.plugin.opts.companionAllowedHosts}`)\n        return\n      }\n\n      // Check if it's a string before doing the JSON.parse to maintain support\n      // for older Companion versions that used object references\n      const data = typeof e.data === 'string' ? JSON.parse(e.data) : e.data\n\n      if (!data.token) {\n        this.plugin.uppy.log('did not receive token from auth window')\n        return\n      }\n\n      authWindow.close()\n      window.removeEventListener('message', handleToken)\n      this.provider.setAuthToken(data.token)\n      this.preFirstRender()\n    }\n    window.addEventListener('message', handleToken)\n  }\n\n  #isOriginAllowed (origin, allowedOrigin) {\n    const getRegex = (value) => {\n      if (typeof value === 'string') {\n        return new RegExp(`^${value}$`)\n      } if (value instanceof RegExp) {\n        return value\n      }\n    }\n\n    const patterns = Array.isArray(allowedOrigin) ? allowedOrigin.map(getRegex) : [getRegex(allowedOrigin)]\n    return patterns\n      .filter((pattern) => pattern != null) // loose comparison to catch undefined\n      .some((pattern) => pattern.test(origin) || pattern.test(`${origin}/`)) // allowing for trailing '/'\n  }\n\n  handleError (error) {\n    const { uppy } = this.plugin\n    uppy.log(error.toString())\n    if (error.isAuthError) {\n      return\n    }\n    const message = uppy.i18n('companionError')\n    uppy.info({ message, details: error.toString() }, 'error', 5000)\n  }\n\n  handleScroll (e) {\n    const scrollPos = e.target.scrollHeight - (e.target.scrollTop + e.target.offsetHeight)\n    const path = this.nextPagePath || null\n\n    if (scrollPos < 50 && path && !this.#isHandlingScroll) {\n      this.provider.list(path)\n        .then((res) => {\n          const { files, folders } = this.plugin.getPluginState()\n          this.#updateFilesAndFolders(res, files, folders)\n        }).catch(this.handleError)\n        .then(() => { this.#isHandlingScroll = false }) // always called\n\n      this.#isHandlingScroll = true\n    }\n  }\n\n  listAllFiles (path, files = null) {\n    files = files || []\n    return new Promise((resolve, reject) => {\n      this.provider.list(path).then((res) => {\n        res.items.forEach((item) => {\n          if (!item.isFolder) {\n            files.push(item)\n          } else {\n            this.addFolder(item)\n          }\n        })\n        const moreFiles = res.nextPagePath || null\n        if (moreFiles) {\n          return this.listAllFiles(moreFiles, files)\n            .then((files) => resolve(files))\n            .catch(e => reject(e))\n        }\n        return resolve(files)\n      }).catch(e => reject(e))\n    })\n  }\n\n  donePicking () {\n    const { currentSelection } = this.plugin.getPluginState()\n    const promises = currentSelection.map((file) => {\n      if (file.isFolder) {\n        return this.addFolder(file)\n      }\n      return this.addFile(file)\n    })\n\n    this.#sharedHandler.loaderWrapper(Promise.all(promises), () => {\n      this.clearSelection()\n    }, () => {})\n  }\n\n  cancelPicking () {\n    this.clearSelection()\n\n    const dashboard = this.plugin.uppy.getPlugin('Dashboard')\n    if (dashboard) dashboard.hideAllPanels()\n  }\n\n  clearSelection () {\n    this.plugin.setPluginState({ currentSelection: [] })\n  }\n\n  render (state, viewOptions = {}) {\n    const { authenticated, didFirstRender } = this.plugin.getPluginState()\n    if (!didFirstRender) {\n      this.preFirstRender()\n    }\n\n    // reload pluginState for \"loading\" attribute because it might\n    // have changed above.\n    if (this.plugin.getPluginState().loading) {\n      return (\n        <CloseWrapper onUnmount={this.clearSelection}>\n          <LoaderView i18n={this.plugin.uppy.i18n} />\n        </CloseWrapper>\n      )\n    }\n\n    if (!authenticated) {\n      return (\n        <CloseWrapper onUnmount={this.clearSelection}>\n          <AuthView\n            pluginName={this.plugin.title}\n            pluginIcon={this.plugin.icon}\n            handleAuth={this.handleAuth}\n            i18n={this.plugin.uppy.i18n}\n            i18nArray={this.plugin.uppy.i18nArray}\n          />\n        </CloseWrapper>\n      )\n    }\n\n    const targetViewOptions = { ...this.opts, ...viewOptions }\n    const headerProps = {\n      showBreadcrumbs: targetViewOptions.showBreadcrumbs,\n      getFolder: this.getFolder,\n      directories: this.plugin.getPluginState().directories,\n      pluginIcon: this.plugin.icon,\n      title: this.plugin.title,\n      logout: this.logout,\n      username: this.username,\n      i18n: this.plugin.uppy.i18n,\n    }\n\n    const browserProps = {\n      ...this.plugin.getPluginState(),\n      username: this.username,\n      getNextFolder: this.getNextFolder,\n      getFolder: this.getFolder,\n      filterItems: this.#sharedHandler.filterItems,\n      filterQuery: this.filterQuery,\n      logout: this.logout,\n      isChecked: this.#sharedHandler.isChecked,\n      toggleCheckbox: this.#sharedHandler.toggleCheckbox,\n      handleScroll: this.handleScroll,\n      listAllFiles: this.listAllFiles,\n      done: this.donePicking,\n      cancel: this.cancelPicking,\n      headerComponent: Header(headerProps),\n      title: this.plugin.title,\n      viewType: targetViewOptions.viewType,\n      showTitles: targetViewOptions.showTitles,\n      showFilter: targetViewOptions.showFilter,\n      showBreadcrumbs: targetViewOptions.showBreadcrumbs,\n      pluginIcon: this.plugin.icon,\n      i18n: this.plugin.uppy.i18n,\n      uppyFiles: this.plugin.uppy.getFiles(),\n      validateRestrictions: (...args) => this.plugin.uppy.validateRestrictions(...args),\n    }\n\n    return (\n      <CloseWrapper onUnmount={this.clearSelection}>\n        <Browser {...browserProps} />\n      </CloseWrapper>\n    )\n  }\n}\n"]}