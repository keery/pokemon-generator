{"version":3,"sources":["index.js"],"names":["h","Component","require","classNames","shallowEqual","FilePreviewAndLink","FileProgress","FileInfo","Buttons","module","exports","FileItem","componentDidMount","file","props","preview","handleRequestThumbnail","shouldComponentUpdate","nextProps","componentDidUpdate","componentWillUnmount","handleCancelThumbnail","render","isProcessing","progress","preprocess","postprocess","isUploaded","uploadComplete","error","uploadInProgressOrComplete","uploadStarted","uploadInProgress","isGhost","showRemoveButton","individualCancellation","showRemoveButtonAfterComplete","dashboardItemClass","recoveredState","resumableUploads","id","role","showLinkToFileUploadResult","uppy","hideRetryButton","hideCancelButton","hidePauseResumeButton","i18n","acquirers","containerWidth","toggleAddFilesPanel","metaFields","canEditFile","toggleFileCard","openFileEditor"],"mappings":"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","sourcesContent":["const { h, Component } = require('preact')\nconst classNames = require('classnames')\nconst shallowEqual = require('is-shallow-equal')\nconst FilePreviewAndLink = require('./FilePreviewAndLink')\nconst FileProgress = require('./FileProgress')\nconst FileInfo = require('./FileInfo')\nconst Buttons = require('./Buttons')\n\nmodule.exports = class FileItem extends Component {\n  componentDidMount () {\n    const { file } = this.props\n    if (!file.preview) {\n      this.props.handleRequestThumbnail(file)\n    }\n  }\n\n  shouldComponentUpdate (nextProps) {\n    return !shallowEqual(this.props, nextProps)\n  }\n\n  // VirtualList mounts FileItems again and they emit `thumbnail:request`\n  // Otherwise thumbnails are broken or missing after Golden Retriever restores files\n  componentDidUpdate () {\n    const { file } = this.props\n    if (!file.preview) {\n      this.props.handleRequestThumbnail(file)\n    }\n  }\n\n  componentWillUnmount () {\n    const { file } = this.props\n    if (!file.preview) {\n      this.props.handleCancelThumbnail(file)\n    }\n  }\n\n  render () {\n    const { file } = this.props\n\n    const isProcessing = file.progress.preprocess || file.progress.postprocess\n    const isUploaded = file.progress.uploadComplete && !isProcessing && !file.error\n    const uploadInProgressOrComplete = file.progress.uploadStarted || isProcessing\n    const uploadInProgress = (file.progress.uploadStarted && !file.progress.uploadComplete) || isProcessing\n    const error = file.error || false\n\n    // File that Golden Retriever was able to partly restore (only meta, not blob),\n    // users still need to re-add it, so itâ€™s a ghost\n    const { isGhost } = file\n\n    let showRemoveButton = this.props.individualCancellation\n      ? !isUploaded\n      : !uploadInProgress && !isUploaded\n\n    if (isUploaded && this.props.showRemoveButtonAfterComplete) {\n      showRemoveButton = true\n    }\n\n    const dashboardItemClass = classNames({\n      'uppy-Dashboard-Item': true,\n      'is-inprogress': uploadInProgress && !this.props.recoveredState,\n      'is-processing': isProcessing,\n      'is-complete': isUploaded,\n      'is-error': !!error,\n      'is-resumable': this.props.resumableUploads,\n      'is-noIndividualCancellation': !this.props.individualCancellation,\n      'is-ghost': isGhost,\n    })\n\n    return (\n      <div\n        className={dashboardItemClass}\n        id={`uppy_${file.id}`}\n        role={this.props.role}\n      >\n        <div className=\"uppy-Dashboard-Item-preview\">\n          <FilePreviewAndLink\n            file={file}\n            showLinkToFileUploadResult={this.props.showLinkToFileUploadResult}\n          />\n          <FileProgress\n            uppy={this.props.uppy}\n            file={file}\n            error={error}\n            isUploaded={isUploaded}\n            hideRetryButton={this.props.hideRetryButton}\n            hideCancelButton={this.props.hideCancelButton}\n            hidePauseResumeButton={this.props.hidePauseResumeButton}\n            recoveredState={this.props.recoveredState}\n            showRemoveButtonAfterComplete={this.props.showRemoveButtonAfterComplete}\n            resumableUploads={this.props.resumableUploads}\n            individualCancellation={this.props.individualCancellation}\n            i18n={this.props.i18n}\n          />\n        </div>\n\n        <div className=\"uppy-Dashboard-Item-fileInfoAndButtons\">\n          <FileInfo\n            file={file}\n            id={this.props.id}\n            acquirers={this.props.acquirers}\n            containerWidth={this.props.containerWidth}\n            i18n={this.props.i18n}\n            toggleAddFilesPanel={this.props.toggleAddFilesPanel}\n          />\n          <Buttons\n            file={file}\n            metaFields={this.props.metaFields}\n            showLinkToFileUploadResult={this.props.showLinkToFileUploadResult}\n            showRemoveButton={showRemoveButton}\n            canEditFile={this.props.canEditFile}\n            uploadInProgressOrComplete={uploadInProgressOrComplete}\n            toggleFileCard={this.props.toggleFileCard}\n            openFileEditor={this.props.openFileEditor}\n            uppy={this.props.uppy}\n            i18n={this.props.i18n}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n"]}