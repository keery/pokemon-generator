"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.vestResolver = void 0;
const react_hook_form_1 = require("react-hook-form");
const promisify = (validatorFn) => (...args) => new Promise((resolve) => validatorFn(...args).done(resolve));
const parseErrorSchema = (vestError, validateAllFieldCriteria) => {
    return Object.entries(vestError).reduce((prev, [key, value]) => {
        return Object.assign(Object.assign({}, prev), { [key]: Object.assign({ type: '', message: value[0] }, (validateAllFieldCriteria
                ? {
                    types: value.reduce((prev, message, index) => {
                        return Object.assign(Object.assign({}, prev), { [index]: message });
                    }, {}),
                }
                : {})) });
    }, {});
};
const vestResolver = (schema, _ = {}, validateAllFieldCriteria = false) => async (values) => {
    const validateSchema = promisify(schema);
    const result = await validateSchema(values);
    const errors = result.getErrors();
    if (!result.hasErrors()) {
        return { values: values, errors: {} };
    }
    return {
        values: {},
        errors: react_hook_form_1.transformToNestObject(parseErrorSchema(errors, validateAllFieldCriteria)),
    };
};
exports.vestResolver = vestResolver;
//# sourceMappingURL=vest.js.map